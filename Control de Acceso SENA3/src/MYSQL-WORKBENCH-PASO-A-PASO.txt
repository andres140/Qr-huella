╔═══════════════════════════════════════════════════════════════════════╗
║                                                                       ║
║           📊 MYSQL WORKBENCH - GUÍA VISUAL PASO A PASO               ║
║                                                                       ║
╚═══════════════════════════════════════════════════════════════════════╝

═════════════════════════════════════════════════════════════════════════
 PARTE 1: INSTALACIÓN DE MYSQL Y WORKBENCH
═════════════════════════════════════════════════════════════════════════

┌─────────────────────────────────────────────────────────────────────┐
│  PASO 1.1: Descargar MySQL                                          │
└─────────────────────────────────────────────────────────────────────┘

   1. Ir a: https://dev.mysql.com/downloads/installer/
   
   2. Descargar: "MySQL Installer for Windows"
      → mysql-installer-community-8.x.x.msi
      → Tamaño: ~400 MB
   
   3. Click en "No thanks, just start my download"

┌─────────────────────────────────────────────────────────────────────┐
│  PASO 1.2: Instalar MySQL                                           │
└─────────────────────────────────────────────────────────────────────┘

   1. Ejecutar el instalador descargado
   
   2. Elegir tipo de instalación:
      → "Developer Default" (Recomendado)
      ✅ Incluye MySQL Server + Workbench + Shell
   
   3. Click "Next" → "Execute" (descargará componentes)
   
   4. Configuración del Server:
      
      ┌─────────────────────────────────────────────────┐
      │  Tipo:                  Standalone MySQL Server │
      │  Puerto:                3306                    │
      │  Open Windows Firewall: ✅                      │
      └─────────────────────────────────────────────────┘
   
   5. Método de autenticación:
      → ✅ "Use Strong Password Encryption"
   
   6. Configurar password de ROOT:
      
      ╔══════════════════════════════════════════════════╗
      ║  ⚠️  MUY IMPORTANTE - GUARDA ESTA CONTRASEÑA    ║
      ╠══════════════════════════════════════════════════╣
      ║                                                  ║
      ║  MySQL Root Password: ___________________       ║
      ║                                                  ║
      ║  Repite el Password:  ___________________       ║
      ║                                                  ║
      ║  💡 Anótala aquí o en un lugar seguro          ║
      ║     La necesitarás para todo el proyecto        ║
      ║                                                  ║
      ╚══════════════════════════════════════════════════╝
   
   7. Configurar como servicio de Windows:
      → ✅ "Configure MySQL Server as a Windows Service"
      → Nombre: MySQL80
      → ✅ "Start the MySQL Server at System Startup"
   
   8. Click "Execute" → Esperar → "Finish"

═════════════════════════════════════════════════════════════════════════
 PARTE 2: CONFIGURAR MYSQL WORKBENCH
═════════════════════════════════════════════════════════════════════════

┌─────────────────────────────────────────────────────────────────────┐
│  PASO 2.1: Abrir MySQL Workbench por primera vez                    │
└─────────────────────────────────────────────────────────────────────┘

   1. Buscar en el menú de inicio: "MySQL Workbench"
   
   2. Abrir la aplicación
   
   3. Deberías ver una conexión creada automáticamente:
      
      ┌────────────────────────────────────┐
      │  MySQL Connections                 │
      ├────────────────────────────────────┤
      │                                    │
      │  📊 Local instance MySQL80         │
      │     localhost:3306                 │
      │                                    │
      └────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────┐
│  PASO 2.2: Conectar a MySQL                                         │
└─────────────────────────────────────────────────────────────────────┘

   1. Click en "Local instance MySQL80"
   
   2. Te pedirá la contraseña:
      → Ingresa el password de ROOT que configuraste
      → ✅ "Save password in vault" (opcional pero recomendado)
   
   3. Click "OK"
   
   4. Si todo está bien, se abrirá el editor SQL:
      
      ┌────────────────────────────────────────────────┐
      │  File  Edit  View  Query  ...                 │
      ├────────────────────────────────────────────────┤
      │                                                │
      │  [Query 1]  +                                  │
      │  ┌──────────────────────────────────────────┐ │
      │  │                                          │ │
      │  │  -- Escribe tu SQL aquí                 │ │
      │  │                                          │ │
      │  └──────────────────────────────────────────┘ │
      │                                                │
      └────────────────────────────────────────────────┘

═════════════════════════════════════════════════════════════════════════
 PARTE 3: CREAR LA BASE DE DATOS DEL PROYECTO
═════════════════════════════════════════════════════════════════════════

┌─────────────────────────────────────────────────────────────────────┐
│  PASO 3.1: Abrir el script SQL                                      │
└─────────────────────────────────────────────────────────────────────┘

   1. En MySQL Workbench, ir a:
      → File → Open SQL Script...
   
   2. Navegar a tu proyecto:
      → Buscar: backend/database/schema.sql
   
   3. Click "Open"
   
   4. Verás el contenido del archivo en el editor

┌─────────────────────────────────────────────────────────────────────┐
│  PASO 3.2: Ejecutar el script completo                              │
└─────────────────────────────────────────────────────────────────────┘

   Opción A - Ejecutar todo (Recomendado):
   
   1. Click en el botón ⚡ (Execute)
      O presiona: Ctrl + Shift + Enter
   
   2. Espera a que termine (5-10 segundos)
   
   3. En el panel "Output" verás:
      
      ┌──────────────────────────────────────────────┐
      │  Action Output                               │
      ├──────────────────────────────────────────────┤
      │  ✅ CREATE DATABASE successful               │
      │  ✅ CREATE TABLE users successful            │
      │  ✅ CREATE TABLE persons successful          │
      │  ✅ CREATE TABLE access_records successful   │
      │  ✅ CREATE TABLE visitor_qrs successful      │
      │  ✅ CREATE TABLE chat_messages successful    │
      │  ✅ INSERT INTO users successful             │
      │  ✅ CREATE VIEW successful                   │
      │  ✅ CREATE PROCEDURE successful              │
      │  ✅ CREATE EVENT successful                  │
      └──────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────┐
│  PASO 3.3: Verificar que todo se creó correctamente                 │
└─────────────────────────────────────────────────────────────────────┘

   1. En el panel izquierdo "Navigator", actualizar:
      → Click en 🔄 (Refresh) junto a "SCHEMAS"
   
   2. Expandir "huella_sena" → "Tables"
      
      Deberías ver:
      ┌──────────────────────────┐
      │  📊 huella_sena          │
      │  ├── 📋 Tables           │
      │  │   ├── access_records  │
      │  │   ├── chat_messages   │
      │  │   ├── persons         │
      │  │   ├── users           │
      │  │   └── visitor_qrs     │
      │  ├── 👁️ Views            │
      │  │   └── vista_estadis.. │
      │  └── ⚙️ Stored Procedures│
      │      └── limpiar_qrs_..  │
      └──────────────────────────┘
   
   3. ✅ Si ves todo esto → ¡Perfecto!

┌─────────────────────────────────────────────────────────────────────┐
│  PASO 3.4: Verificar el usuario administrador                       │
└─────────────────────────────────────────────────────────────────────┘

   1. En el editor SQL, escribe:
      
      SELECT * FROM huella_sena.users;
   
   2. Click en ⚡ o presiona Ctrl + Enter
   
   3. En "Result Grid" deberías ver:
      
      ┌────┬────────┬────────────────┬──────────────────┬─────────────┬──────────┐
      │ id │usuario │ nombre         │ email            │ rol         │ estado   │
      ├────┼────────┼────────────────┼──────────────────┼─────────────┼──────────┤
      │ 1  │ admin  │Administrador...│admin@huella.com  │ADMINISTRADOR│ ACTIVO   │
      └────┴────────┴────────────────┴──────────────────┴─────────────┴──────────┘
   
   4. ✅ Si ves este usuario → ¡Todo está bien!

═════════════════════════════════════════════════════════════════════════
 PARTE 4: CONSULTAS ÚTILES
═════════════════════════════════════════════════════════════════════════

┌─────────────────────────────────────────────────────────────────────┐
│  Ver todas las tablas                                               │
└─────────────────────────────────────────────────────────────────────┘

   USE huella_sena;
   SHOW TABLES;

┌─────────────────────────────────────────────────────────────────────┐
│  Ver estructura de una tabla                                        │
└─────────────────────────────────────────────────────────────────────┘

   DESCRIBE persons;
   -- O también:
   SHOW COLUMNS FROM persons;

┌─────────────────────────────────────────────────────────────────────┐
│  Ver todos los usuarios                                             │
└─────────────────────────────────────────────────────────────────────┘

   SELECT * FROM users;

┌─────────────────────────────────────────────────────────────────────┐
│  Ver todas las personas                                             │
└─────────────────────────────────────────────────────────────────────┘

   SELECT * FROM persons;

┌─────────────────────────────────────────────────────────────────────┐
│  Ver registros de acceso de hoy                                     │
└─────────────────────────────────────────────────────────────────────┘

   SELECT * FROM access_records 
   WHERE DATE(timestamp) = CURDATE();

┌─────────────────────────────────────────────────────────────────────┐
│  Ver estadísticas                                                   │
└─────────────────────────────────────────────────────────────────────┘

   SELECT * FROM vista_estadisticas;

┌─────────────────────────────────────────────────────────────────────┐
│  Contar total de personas por rol                                   │
└─────────────────────────────────────────────────────────────────────┘

   SELECT rol, COUNT(*) as total 
   FROM persons 
   GROUP BY rol;

┌─────────────────────────────────────────────────────────────────────┐
│  Ver mensajes del chat                                              │
└─────────────────────────────────────────────────────────────────────┘

   SELECT * FROM chat_messages 
   ORDER BY timestamp DESC 
   LIMIT 10;

┌─────────────────────────────────────────────────────────────────────┐
│  Limpiar todos los datos (CUIDADO!)                                 │
└─────────────────────────────────────────────────────────────────────┘

   -- ⚠️ Esto borrará TODOS los datos
   TRUNCATE TABLE access_records;
   TRUNCATE TABLE chat_messages;
   TRUNCATE TABLE visitor_qrs;
   TRUNCATE TABLE persons;

═════════════════════════════════════════════════════════════════════════
 PARTE 5: EXPORTAR/IMPORTAR DATOS
═════════════════════════════════════════════════════════════════════════

┌─────────────────────────────────────────────────────────────────────┐
│  Exportar Base de Datos (Backup)                                    │
└─────────────────────────────────────────────────────────────────────┘

   1. En MySQL Workbench:
      → Server → Data Export
   
   2. Seleccionar:
      ☑ huella_sena
   
   3. Elegir tablas a exportar (o todas)
   
   4. Export Options:
      → ⦿ Export to Self-Contained File
      → Browse... → Elegir ubicación (ej: backup.sql)
   
   5. Click "Start Export"
   
   6. ✅ Archivo backup.sql creado

┌─────────────────────────────────────────────────────────────────────┐
│  Importar Base de Datos (Restaurar)                                 │
└─────────────────────────────────────────────────────────────────────┘

   1. En MySQL Workbench:
      → Server → Data Import
   
   2. Import Options:
      → ⦿ Import from Self-Contained File
      → Browse... → Seleccionar tu archivo .sql
   
   3. Default Target Schema:
      → huella_sena
   
   4. Click "Start Import"
   
   5. ✅ Datos restaurados

═════════════════════════════════════════════════════════════════════════
 PARTE 6: SOLUCIÓN DE PROBLEMAS
═════════════════════════════════════════════════════════════════════════

┌─────────────────────────────────────────────────────────────────────┐
│  ❌ Error: "Access denied for user 'root'@'localhost'"             │
└─────────────────────────────────────────────────────────────────────┘

   Solución:
   1. Verifica que la contraseña sea correcta
   2. En Windows, busca "Services"
   3. Busca "MySQL80" → Click derecho → Restart

┌─────────────────────────────────────────────────────────────────────┐
│  ❌ Error: "Can't connect to MySQL server on 'localhost'"          │
└─────────────────────────────────────────────────────────────────────┘

   Solución:
   1. Verifica que MySQL Server esté corriendo
   2. Windows: Services → MySQL80 → Estado: Running
   3. Si está detenido → Click derecho → Start

┌─────────────────────────────────────────────────────────────────────┐
│  ❌ Error: "Database 'huella_sena' doesn't exist"                  │
└─────────────────────────────────────────────────────────────────────┘

   Solución:
   1. Ejecuta nuevamente el script schema.sql
   2. O crea manualmente:
      CREATE DATABASE huella_sena;
      USE huella_sena;

┌─────────────────────────────────────────────────────────────────────┐
│  ❌ La vista "vista_estadisticas" no se muestra                    │
└─────────────────────────────────────────────────────────────────────┘

   Solución:
   1. Actualizar schemas: Click en 🔄 (Refresh)
   2. Expandir "huella_sena" → "Views"
   3. Click derecho → Refresh All

═════════════════════════════════════════════════════════════════════════
 PARTE 7: TIPS Y TRUCOS
═════════════════════════════════════════════════════════════════════════

💡 TIP 1: Atajos de teclado útiles
   
   Ctrl + Enter         → Ejecutar query actual
   Ctrl + Shift + Enter → Ejecutar todo el script
   Ctrl + T             → Nueva pestaña
   Ctrl + W             → Cerrar pestaña
   Ctrl + /             → Comentar/descomentar línea

💡 TIP 2: Auto-completado
   
   Escribe parte de una palabra y presiona Ctrl + Espacio
   para ver sugerencias de tablas, columnas, etc.

💡 TIP 3: Formato de código
   
   Click derecho en el editor → Beautify Query
   O presiona: Ctrl + B

💡 TIP 4: Múltiples queries
   
   Puedes escribir varios queries separados por ;
   El que tenga el cursor será el que se ejecute con Ctrl+Enter

💡 TIP 5: Guardar queries frecuentes
   
   File → Save SQL Script → Guardar como .sql
   Luego: File → Open SQL Script para reutilizar

═════════════════════════════════════════════════════════════════════════

                     ¡Base de Datos Lista! 🎉

          Ahora puedes iniciar el backend con: npm run dev

═════════════════════════════════════════════════════════════════════════
